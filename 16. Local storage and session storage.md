# 16. Local storage and session storage

- â€‹              [Content](https://learn.extensionschool.ch/learn/programs/web-application-development-v1/subjects/advanced-javascript-techniques-v1/units/local-storage-and-session-storage-v1#content)            

In the last couple of units, we've looked at how to format some data in a  string using the JSON format, and we've seen how it's possible to  request and send data to a *remote* server using AJAX.

In this unit, we'll have a look at how to use JavaScript to store small amounts of data *in the browser* and how to retrieve that data.  And we'll use JSON as the format to store things, so we'll be using `JSON.stringify()` and  `JSON.parse()`.

When we talk about "local storage" with JavaScript, we mean the  ability to store small amounts of data related to a particular website  or web page in a particular browser.  We're enabling someone to store  data locally in the current browser that they have open.  "Local  storage" is a relatively new feature in all modern browsers that can be  controlled with JavaScript.

The format that we store data is with simple *key-value pairs*.  Local storage allows us to store any string value using a particular  "key", which is also needs to be a string.  The value will be stored in  local storage and we can use the "key" to retrieve the value whenever we want in future.

Let's look at an example using local storage first.

```javascript
localStorage.setItem('email', 'me@extensionschool.ch');
```

The one line above is all that's needed to add a value in local storage.  In the example, we call the method `setItem` with the *key* that is we want to use to retrieve the value,`'email'`, and the value itself, `'me@extensionschool.ch'` *writes* this key and value to the local storage area within the browser for this particular page.

Having stored a value in local storage, we can access the value stored with the key `'email'` on any of the other pages of our website using JavaScript, like this:

```javascript
let storedEmail = localStorage.getItem('email');

console.log('Stored email is ' + storedEmail); // outputs 'Stored email is me@extensionschool.me'
```

We can also remove the value for a particular key using `localStorage.removeItem()` in order to delete the stored value and key.

```javascript
localStorage.removeItem('email');

let newValue = localStorage.getItem('email');

console.log('Stored email is ' + newValue); // outputs 'Stored email is null'
```

We can even clear *all* of the values in local storage for the current website or web page using `localStorage.clear()`.

```javascript
localStorage.setItem('preferredColor', 'green');
localStorage.setItem('preferredDrink', 'tea');
localStorage.setItem('preferredSize', 'large');

localStorage.clear();

localStorage.getItem('preferredColor'); // null, not 'green'
localStorage.getItem('preferredDrink'); // null, not 'tea'
localStorage.getItem('preferredSize'); // null, not 'large'
```

So local storage is an easy way for us to store some simple strings in the current browser by writing some JavaScript.

## Storing JSON

Let's think about how we can combine what we know about JSON with our new knowledge about local storage.

We've seen that we can convert a JavaScript object into JSON using `JSON.stringify()`; this means that we can convert a JavaScript object into a string.  And  we can store strings in local storage.  So we can store a JavaScript  object in local storage by converting it to JSON first.

```javascript
let book = {
  title: 'Dune',
  author: 'Frank Herbert',
  firstPublished: 1965,
  allDetails: () => { return this.title + ', by ' this.author + ' (first published ' + this.firstPublished + ')'
};

let bookAsJson = JSON.stringify(book);

localStorage.setItem('currentlyReading', bookAsJson);
```

We can then do the reverse of this operating and retieve a stored  JavaScript object.  First, we retrieve the JSON string from local  storage, and then we can use `JSON.parse` to convert the string into a JavaScript object.

```javascript
let stringValue = localStorage.getItem('currentlyReading');

let currentlyReading = JSON.parse(stringValue);

console.log(currentlyReading.title); // "Dune"
console.log(currentlyReading.author); // "Frank Herbert"
console.log(currentlyReading.firstPublished); // "1965" - notice that this has been converted to a string, _not_ an integer!
console.log(currentlyReading.allDetails()); // throws an error because functions are not stored in JSON:  'TypeError: book.allDetails is not a function'
```

Just remember: this process of converting a JavaScript object to JSON and back will *only* preserve the properties of the object and *will not* preserve any functions from the original object.  So this process is  best suited to simple JavaScript objects that don't contain functions.

## A note on security

We've seen that local storage is really useful for storing small bits of data for later use on a website.  However, we *must* be careful about what data we store in local storage.  Local storage is not encrypted for an individual using that website.

As an example, imagine that you have written a small website that  will allow people to make a note of birthday gifts that they plan to buy for their loved ones.  The web page uses local storage to track the  gifts.  This means that the list of gifts will be displayed to *anyone* who visits the web page in that browser on that computer.  There is no  privacy protection in local storage so think carefully about when and  when *not* to use local storage.

## A note on portability

Equally important is to thoroughly understand where local storage *exists*.  A value stored in local storage is *only tracked in the browser and computer that it was originally added to*.

There is no mechanism that transports that value and it's key to a  different browser.  This is why we can view local storage as a  compliment to accessing an API with AJAX.  The API is the centralized  storage, where we can retrieve the same data from any browser and that  can handle storing large amounts of data, and local storage is how we  can store small amounts of data that can be used by one user in more  temporary scenarios.

It's also important to understand that values in local storage are *isolated to the website that they were created on*.  If a value is set in local storage on the domain `www.extensionschool.com`, that key-value pair *will not* be available on any other domain.

## Session storage

There is a second, more temporary storage area that can be accessed  with JavaScript and is very similar in usage to local storage.  This is *session storage*.  We interact with the `sessionStorage` object to use session storage, and it is used in exactly the same way with JavaScript as the `localStorage` object. So we use the methods `sessionStorage.setItem()`, `sessionStorage.getItem()`, `sessionStorage.removeItem()`, and `sessionStorage.clear()`.

The difference is that session storage will be *emptied entirely* when the current page session ends.  It works as if the browser automatically calls `sessionStorage.clear()` whenever the browser window or the application is closed.  Hence it is a more temporary alternative to local storage.

Session storage is normally used as an equivalent to setting values  in cookies, but with more structure and larger values.  This is because  session storage and cookies are similar in the way that they expire.  A  cookie can be used to track the identifier for a logged in user, and  session storage can be used to store particular personal settings for  that user for the website in question.  Examples might be the last  search term that was entered, preferences for showing or hiding  different parts of the page, or the preferred color scheme of the  website.  It might even be used for more personal information than that.

Session storage is slightly safer than local storage from a privacy  point of view because it is emptied when a session ends.  But it's still very important to consider what data we store in session storage.  

## Summary

Local storage is a simple way to store values as strings in the  website that someone is currently using, with JavaScript.  Local storage does not transfer values to different browsers or computers but does  stay stored in the browser indefinitely.  This means local storage is  useful for storing values that customize an individual's experience or  to store non-critical and non-confidential information that someone is  working on, for example shopping items in an e-commerce basket.

Session storage is a second area for storing values as strings and is almost identical in usage to local storage.  The difference is that all values in session storage will be deleted when a session ends, such as  when the browser application is closed.  Session storage can be used as  an alternative place to store values to cookies.

Now let's make use of local storage, JSON and some AJAX calls in the exercise in the following unit.